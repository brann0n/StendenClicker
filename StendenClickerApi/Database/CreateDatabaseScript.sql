DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'StendenClickerApi.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '202103171345293_test1'
BEGIN
    IF object_id(N'[dbo].[FK_dbo.Heroes_dbo.Players_Player_PlayerId]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[Heroes] DROP CONSTRAINT [FK_dbo.Heroes_dbo.Players_Player_PlayerId]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Player_PlayerId' AND object_id = object_id(N'[dbo].[Heroes]', N'U'))
        DROP INDEX [IX_Player_PlayerId] ON [dbo].[Heroes]
    CREATE TABLE [dbo].[HeroPlayers] (
        [Hero_HeroId] [int] NOT NULL,
        [Player_PlayerId] [int] NOT NULL,
        CONSTRAINT [PK_dbo.HeroPlayers] PRIMARY KEY ([Hero_HeroId], [Player_PlayerId])
    )
    CREATE INDEX [IX_Hero_HeroId] ON [dbo].[HeroPlayers]([Hero_HeroId])
    CREATE INDEX [IX_Player_PlayerId] ON [dbo].[HeroPlayers]([Player_PlayerId])
    DECLARE @var0 nvarchar(128)
    SELECT @var0 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Heroes')
    AND col_name(parent_object_id, parent_column_id) = 'Player_PlayerId';
    IF @var0 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Heroes] DROP CONSTRAINT [' + @var0 + ']')
    ALTER TABLE [dbo].[Heroes] DROP COLUMN [Player_PlayerId]
    ALTER TABLE [dbo].[HeroPlayers] ADD CONSTRAINT [FK_dbo.HeroPlayers_dbo.Heroes_Hero_HeroId] FOREIGN KEY ([Hero_HeroId]) REFERENCES [dbo].[Heroes] ([HeroId]) ON DELETE CASCADE
    ALTER TABLE [dbo].[HeroPlayers] ADD CONSTRAINT [FK_dbo.HeroPlayers_dbo.Players_Player_PlayerId] FOREIGN KEY ([Player_PlayerId]) REFERENCES [dbo].[Players] ([PlayerId]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202103171345293_test1', N'StendenClickerApi.Migrations.Configuration',  0x1F8B0800000000000400ED5DDB6EE3C8117D0F907F20F89404B3962D094162C8BBF0DAE35D6377C683D1CC226F062DB56D6229522129C346902FCB433E29BF90E6BD2FD5573629D918CCCB58DD5D5D557DAAD9557DA9FFFDE7BF8B1F9E3791F784D22C4CE233FFE4E8D8F750BC4AD661FC70E6EFF2FBEFFEE6FFF0FD1FFFB078BFDE3C7BBF35F566453DDC32CECEFCC73CDF9E4E26D9EA116D82EC6813AED2244BEEF3A355B29904EB64323D3EFEFBE4E4648230091FD3F2BCC5E75D9C871B54FE81FFBC48E215DAE6BB20FA90AC5194D5BFE3926549D5FB186C50B60D56E8CC5FE6285EA3F8220A57BFA3F47C1B1E5D0679701764C8F7CEA330C01C2D5174EF7B411C277990637E4FBF666899A749FCB0DCE21F82E8CBCB16E17AF74154B42AE538EDAAEB8A743C2D449A740D1B52AB5D96271B438227B35A4713B6B995A6FD5687588BEFB1B6F39742EA529367FE8F4996F91EDBD1E945941695644A3E2A9ABEF3B80AEF5A70600C15FFDE7917BB28DFA5E82C46BB3C0DA277DEA7DD1DAEFF0B7AF992FC8EE2B3781745249B98515C46FD807FFA94265B94E62F9FD13DC1FCF5DAF72674DB09DBB86DCAB4AB44BC8EF3D9D4F73E622682BB08B56820D4B1CC9314FD84629406395A7F0AF21CA57830AFB1E0853E390E80FE8AFF353D620862ABF2BD0FC1F3AF287EC81FCF7CFC5FDFBB0A9FD1BAF9A5E6E26B1C6223C48DF27487941DE171F9190551FEA8128EA1F331780A1F4A5901D6CFB30CE5BEF71945658DEC31DC56A65542E096A87295269BCF4954B7EB4A6E97C92E5D15F22760F197207D28DA935C2D261D58A510BEDE040FA866C00AC81D81FDC2B9E3C306D474EBB1A05DF67A89B2551A6EAB296A0488FF755E76EBB82F6DC05DA521064961069680EB08EC17701D1F3680A35B0F0638E1D4F4290A5E507A024E4C1D6FB76DB56E72E24BB9090AA8024D526AFEA67AFC4DA5FC4DD5FC4DFB4DA215114B3C578DF78BE58A071B1C772DC79A34AB1E7FDA85EBC1A7CBAAAB51161F97E8295CA1EBE165C24E428C56C5400CD199D09E7F46698232D09C8BA2DA0E33D290C9DF5BFB6C4C982A6CECDBCA780B4A96A65B34DDAFE1161CD8986DD36E2CA32DFA1BC58E4AC1E2FB24DD04A3ACA88AFE2E922C77E53214F4C42E43897AA20A632C6D09F7C5638AEDBEC63DCC17E487B56D2BF3FD8099C9AD3FBE75EBFD1A71CD848D1D134DC732E5BACB57EA92D7DC8B4DACAE704B57EC600D9573F0062BF582F9728507CC12E465DBFD42BC64C106E06DC3B1E05D76380CB885A02CFB1443B22CBE252B757064CB38287215FACDB6181F61356F2F5196955F58BB899723B4E73998E3C76A3A06A91C9677CFF30879F9E25AFC6427AEEAD2EB177633D5E29B8F0248AADAF13D33E37BA6C5F74C9FEF9925DF7333BEE75A7CCFF5F99EF79B93BE6E1FD2606DFB71AC5BEF77F6A999B0997288A6637D22EB2E475901D67D59B858023D65E77761540A5951FB31C1E00CE29E2E1B68417597B75585CE66C8DF392BA10A4DEC027FDD935558F2406C3F111B4CB438EFE3B527DF6DAA06B6D9A9C2635BD8EF16C31D777EE6FF85539090621BBBE92892DB4E34DDE3A3A31356604234B9C48C7F2CE24FE42C77FC5543A62FB1C0BF1E49E2C6FB9672C7B9E23DA5E522731DBD261E2EA5682024B02121624DB63BD131486E42E98B2DD9D6500ADF6B90810D0F6D1EA703CA3F1D497ED02717712977D03B3EDBC091BE02A46EFDF0B6CEF981223EC54E61C7631D50D0175EE8480E2FB8C465110E9586FF426001706B0D60A1768006B60FB16B64CC33385F0CA49FD1E60FB10B66CCF36C44FDCCF6AD9FB9B97EE623EA673E927EA885BC884B7855DFF1D5BAA9FA8283BE8062DD662068E5475C24711E84D8176CBE32941FDC9D0AE5BCEBAF19AA1DECACF6E558390AF24B9413EE48B105DCB92F947BC169816EDD7D5A2012E4874741A85BC54084C895918250BBE7C5116920A820D0EC8973EDAB7155B4AE172150FB7669A320517ECC2102F5E240D5BC32469003C0E015D46AB043D45AD3614810B8A661461EAB242AC1072FD9F08CD2336E39EF303DD126D29831418482361BFFA165D4909FDD23E6E59779C93A7E32C17A036189FC02D77858F95BDB14480F7ACC6A9FD94272D64D2648B44CF696193AB1C74BAE72A3751D6942046A3295A842E23A8FA390A99642A6260A993A55C8745885C0DBDABC4AD4AEB6BEB34D08D27DAC243A91BAD783CD17FCEE2AAF15B9E7ADE77B130234DF5D892E84DEF6607A90ED0B0238D174C94D9D72524BEDF2428619B5EF3D8C3D4976230DB4259B70345C7467DA1A7AF691EC811A686B66A3AD997B6DCDF6A4ADB991B6E636DA9ABBD7D67C586DD1BB6CBC7EC4CEBBDA7D2718EEDC13890E40875DB9689408DD6CF6B54E7A5BB69854973AEB1F1613C1EDCFC58760BB0DE307E23668FD8BB7ACAE825E7CB734BF1BB9A9684C56D41A9A0D29B43DE5498ABF554C6971187D8DAEC234CBBB30C3C57AC35513842404FE64D3291575E0C7ACF1319BEAC5FFA10808776D93A5D569F40A0BB941715ECA8B1837916FE615177383284805372C2F9268B78965B7355554AA2D7A964EF5AB0125E21426458BF89DA7B698305A618760C28D016315EC886A8D37B9287234E84470C97CE8658D450AA76F23922A97DD725452A46E1A7254A9523370B4570A5974B40507030FD23F73040F2264680E0F596391CAE9BB83A4CE657712F7A87471B4C54AE17578D55CD9A286224557F5592577BFEA5B49D5A6BAB4C6D3AA7E37A5C64FEEE4EFFAD4BAAB6724ADEE577D4AF4DD32921A5D7230C0ACD7638E7009AD303550093713E9B8B9B9456A17BE05A6A2C2E3A7FBD58C1275E18A638C2C34A35B9DFA630956BF1E0C86DAD0962314359B37E64012B614E998B83D442A59781F4983160F2AAAE08D2E3AEB809E230454BB6FE6E32F6827D2707BB58654AFE0A28E920E3FEEC4CF87334E4D20C395ADF2DB9C1666AB41446875E08513CAFC342EB6EC7144DAB08AA31169B68ACD8741D852A47BE2E43DA970E1597E0D5ABC155105C6F4F80F2855604C8F383D0F89DC958E8F2F3A84C6C780C82301DAA11EB2914E4CA708050261187EFB9F578F6120A0A3280F09146A6B5932E6B68E836A726B12B792F285BD8575589EBFBACE8A6B19ED950C730DB0B15563ECB0C729B43D01B291CE921F180DF8E8446FEC74149D62073E2DA2C9AD895BD31F3B7A1A70839D76A7431F396D130837701043341ECC09969EA3716B35240AD6CC602D8BC9DC8A433362067B8F3274F8C63070D835D48F0F026A159FB271A0DC132BEDEAF269864FDB0868FF9943A50BF7689ADAA269EA1A4D5387689A0E88A6E92B43935817BDD1041FFB328943314D35634EC030C94E77F55ED250449DAE6A6427DC34D9360FB3F54796B6427A438C3F3FA71FE4A29A6985B38011121D95EB0D2A82A45348898E086A326C16B7EB0F254D35F49FAB2407102DA371E275953AE806CD05CAC38687B5CE529FB7D49DC11C85195FC1FA4B76B0B31F0A81F5985B141EE8FA4C7D8EF595A270C8759BE4C06C3F14CE8646E1CC210A6723A070F6CA5128D6D170289CF745E17C6814CE1DA2703E020AE7AF1C85621DF546217DC0DB6417B06EA2B9D3070C17749EFB4042A8D079754DD6CC372EDD44DC05A2AB01C29D8267ABB49B8BF52FEDDFED29F8FA04BA3A31127724BDAAE27B58FCA7705D1E477FC1AEF5A644DBD1F29F1106208AF3AEC287200EEF5196574FC2F9D3E393299353E970F21B4DB26C4DBD58274872440FD888F985C2B8890CC8DEAB337C0B8E4D29143F05E9EA3148FFB4099EFF4C52B37BA3B8E4D98225C8C72628720F305CE3E9EFF9CCFF5749E2D4BBFEC72D4CE59D7793625C9E7AC7DEBFE5D2D9A40DB28086FB5C3D83C044949EA7375C98143C06F46CD2EC580C90FBDC36830C101F0C303317B6BDBEA1887899F6E4656AC18B699A1A0B3C88D776A6F96106C4019912A6978992C7E81D906353BBF42206A56F1962FE009E3A1A3121C92028617390F41A07419E91DE34C9876E6DD611A2932D6693114C65802909DC3E1C3F6BC620780312651CC04253B23168861121A10160026C058E9B7762108070A9267AC143B84D6736AC023243D8BE22E07728891BBE2D5D075BBA8A7899F5E465E69097794F5EE6432EE9C150E6F8390706311120CD40AF0912482560F301152512B80BED566BB7C0D257738956371D0057A283C6FA4E8038CE2D722F253B083ADEC3707A3498D07BCE15CAA90260C5793E08F22D55CBB7BD297AD5F3AEDC7BAFAA6770313C505A4C1D4174512C35D320E42F0D7D4AC378156E8388E79DDF0C310B44169A6DC9B32597685B6E3EE5A48C3A3DEADFDB69BB606C41A517F7E9325C03A2DBC833CA3FF1AA0021780B009E2B0F0B10B22B23A6A3C8BF0678135FA208E5C83B5F559B5E1741B6821EF72DB61C657DD79F279683E6E741D06434AA0E10047D82253D4AF696C7060FB4594E0C203078F0C0BD3100190CA8ECCCC95020522CC446029241BA1F6D1C293E49E4B3EF82D7E0DF041EA46F5589FA949F48DE0720C4794DBE01620440C80F078F0008A38450AE97AF6D760528E3C29B5AC48A9F22126EC71CCC52563B59966B78D4B933F86C1A6F0A1AA2378A045B3007030B8B5462AE3E29504E1445CA9437F189D17A24E960D71E16B9D5BE01668F80D9FFDAC43CD9DC37C0EC1130F23B46FB048C38FBDE37C0EC1130F2EB402300462B1DA1567856018F36EF1A948BEDD50758C54F05EE3FBACADC77690F7FB2E912D891A353EA551B6DDDF620B5FF56DD6B39F3D777054EAAED45389D9D2417A3221523D4872C6B11DB11196EE13A220BA18E24A9B804B91C25A91CA10EEA58B7927865791CE9FA721A4058902684A5DB061D38D26D09445D948B0B4E0F29CE0E09D186335BF19C031F165E08A012280F574FCD403B8B71BDB6255057A22430E0900B3145168A865F842DFAAA1CBCB1DF27E5256FDA4B268B053FFDB15BFDEC23998AFB7E1A023ACC69D94F40D294DB17F95C09C86CBC2A72570A2E7D9A32CBB5A061CB3E3BE858D42647924254F8EA2DB020269886191E5DDC015273DA09CB7F4BD927E10610B67FDACDC31576A0949AFD2628664DB024DF68EB2FB2E35C99FD44A59627CBEEC53007233B7C2A4C3B588BD74DA22734065486BB4C976F4019EE1259BE0165B8CB53F97A94E1280DA5F99A8D7165A8174EF4C5324834C93FA5B1987CDEE1D69BEAFCF1E21265E1434762D1DD59ED8836758A3B944DB885E1A8A9C25ED54179B00EF2E03CCDC3FB6095E3E255318AF183EFFD16443B5CE5FDE60EADAFE39B5DBEDDE5C5876473175149098A888DACFF329B26CDF3E2A67C03207321026633C422A09BF8C75D18AD5BBEAF80D3DD02124528A8BE6B518C655EDCB9787869297D4CD80FA18850ADBE3682F5056DB6112696DDC4CBE009D9F0F63543BFA28760F5D2BC882226A21E085AED8BCB30C0D0DE64358DAE3DFE136378BD79FEFEFF764ADB3790AF0000 , N'6.2.0-61023')
END

